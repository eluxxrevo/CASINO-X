<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Casino-X 🎰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: url('https://i.ibb.co/fxNZGLK/candle-bg.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #0f0;
      text-align: center;
      padding: 20px;
    }
    input, button {
      padding: 12px;
      margin: 8px;
      width: 80%;
      max-width: 300px;
      border-radius: 8px;
      border: none;
      outline: none;
      background: #111;
      color: #0f0;
      font-size: 16px;
    }
    button {
      background: #0f0;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    .game-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      justify-content: center;
      max-width: 600px;
      margin: auto;
    }
    .game-icon {
      background: #111;
      border-radius: 16px;
      padding: 20px;
      font-size: 24px;
      transition: 0.3s;
    }
    .game-icon:hover {
      background: #0f0;
      color: #000;
    }
    .mine-grid {
      display: grid;
      grid-template-columns: repeat(5, 50px);
      justify-content: center;
      gap: 8px;
      margin-top: 20px;
    }
    .cell {
      width: 50px;
      height: 50px;
      background: #111;
      color: #0f0;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 6px;
    }
    .cell.revealed {
      background: #0f0;
      color: #000;
    }
    .cell.mine {
      background: red;
      color: white;
    }
  </style>
</head>
<body>
  <h1>🎰 Casino-X</h1>

  <!-- Auth Section -->
  <div id="auth">
    <h2>Register / Login</h2>
    <input type="email" id="email" placeholder="Email" /><br />
    <input type="password" id="password" placeholder="Password" /><br />
    <label>
      <input type="checkbox" id="ageCheck" /> I am 18+ and agree to the
      <a href="terms.html" target="_blank">Terms</a>
    </label><br />
    <button onclick="register()">Register</button>
    <button onclick="login()">Login</button>
    <p id="error" style="color:red;"></p>
  </div>

  <!-- Dashboard -->
  <div id="dashboard" class="hidden">
    <h2>Welcome, <span id="userEmail"></span></h2>
    <p><strong>Balance:</strong> $<span id="userBalance">0</span></p>

    <div class="game-grid">
      <div class="game-icon" onclick="showGame('mines')">💣 Mines</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🎡 Spin the Bottle</div>
      <div class="game-icon" onclick="alert('Coming soon!')">⌚ Rolex</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🍉 Fruit Hunt</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🎯 Spin to Win</div>
      <div class="game-icon" onclick="alert('Coming soon!')">✈️ Aviator</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🚂 Casino Hero</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🏓 Ping Pong</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🏏 Wicket Blast</div>
      <div class="game-icon" onclick="alert('Coming soon!')">🔢 Number Drop</div>
    </div>

    <br />
    <button onclick="goToProfile()">👤 Profile</button>
    <br /><br />
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Game: Mines -->
  <div id="game-mines" class="hidden">
    <h3>💣 Mines Game</h3>
    <p>Number of mines (1–24):</p>
    <input type="number" id="mineCount" min="1" max="24" placeholder="Mines" />
    <input type="number" id="betAmount" placeholder="Bet amount" />
    <button onclick="startMinesGame()">Start Game</button>
    <div class="mine-grid" id="mineGrid"></div>
    <p id="mineResult"></p>
    <button onclick="backToDashboard()">⬅️ Back</button>
  </div
    <!-- Profile Page -->
  <div id="profile" class="hidden">
    <h2>👤 User Profile</h2>
    <p>Email: <span id="profileEmail"></span></p>
    <p>Balance: $<span id="profileBalance">0</span></p>
    <br />
    <button onclick="window.open('https://paystack.com/buy/casino-x-wgojzd')">💳 Deposit</button><br />
    <input type="number" id="withdrawAmount" placeholder="Withdraw amount (min $5)" />
    <button onclick="withdraw()">Withdraw</button><br />
    <button onclick="alert('Customer Care: casinoxsupport@example.com')">📞 Customer Care</button><br /><br />
    <button onclick="backToDashboard()">⬅️ Back</button>
  </div>

  <p style="margin-top: 50px; color: #888;">Endorsed by Reverend</p>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDOfuS7bXfY8AouF3SoP17jzCQTPH90K9w",
      authDomain: "casino-x-87092.firebaseapp.com",
      projectId: "casino-x-87092",
      storageBucket: "casino-x-87092.appspot.com",
      messagingSenderId: "834980865993",
      appId: "1:834980865993:android:77964ded59f8fcb97fea18",
      databaseURL: "https://casino-x-87092-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);

    function register() {
      const email = emailInput.value;
      const password = passwordInput.value;
      const ageChecked = document.getElementById("ageCheck").checked;

      if (!ageChecked) {
        error.textContent = "You must confirm you're 18+.";
        return;
      }

      firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((cred) => {
          firebase.database().ref("users/" + cred.user.uid).set({
            email: email,
            balance: 9  // $10 starting - $1 registration fee
          });
        })
        .catch(err => error.textContent = err.message);
    }

    function login() {
      firebase.auth().signInWithEmailAndPassword(
        emailInput.value,
        passwordInput.value
      ).catch(err => error.textContent = err.message);
    }

    function logout() {
      firebase.auth().signOut();
    }

    function showGame(game) {
      document.getElementById("dashboard").classList.add("hidden");
      document.getElementById("game-" + game).classList.remove("hidden");
    }

    function backToDashboard() {
      document.querySelectorAll("div[id^='game-']").forEach(div => div.classList.add("hidden"));
      document.getElementById("profile").classList.add("hidden");
      document.getElementById("dashboard").classList.remove("hidden");
      updateBalance();
    }

    function goToProfile() {
      const user = firebase.auth().currentUser;
      if (!user) return;
      document.getElementById("dashboard").classList.add("hidden");
      document.getElementById("profile").classList.remove("hidden");
      document.getElementById("profileEmail").textContent = user.email;
      firebase.database().ref("users/" + user.uid).once("value").then(snap => {
        document.getElementById("profileBalance").textContent = snap.val().balance || 0;
      });
    }

    function withdraw() {
      const amount = Number(document.getElementById("withdrawAmount").value);
      const user = firebase.auth().currentUser;
      if (!user || amount < 5) return alert("Minimum withdrawal is $5");
      const ref = firebase.database().ref("users/" + user.uid);
      ref.once("value").then(snap => {
        const bal = snap.val().balance;
        if (bal < amount) return alert("Insufficient funds.");
        ref.update({ balance: bal - amount });
        alert("Withdrawal request of $" + amount + " sent!");
        updateBalance();
      });
    }

    function updateBalance() {
      const user = firebase.auth().currentUser;
      if (!user) return;
      firebase.database().ref("users/" + user.uid).once("value").then(snap => {
        const bal = snap.val().balance || 0;
        document.getElementById("userBalance").textContent = bal;
        document.getElementById("profileBalance").textContent = bal;
        document.getElementById("profileEmail").textContent = user.email;
      });
    }

    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        auth.classList.add("hidden");
        dashboard.classList.remove("hidden");
        userEmail.textContent = user.email;
        updateBalance();
      } else {
        auth.classList.remove("hidden");
        dashboard.classList.add("hidden");
      }
    });

    // Mines Game Logic
    let mineData = [];
    function startMinesGame() {
      const count = Number(document.getElementById("mineCount").value);
      const bet = Number(document.getElementById("betAmount").value);
      const user = firebase.auth().currentUser;
      if (!user || count < 1 || count > 24 || bet <= 0) return;

      firebase.database().ref("users/" + user.uid).once("value").then(snap => {
        const bal = snap.val().balance || 0;
        if (bal < bet) return alert("Insufficient balance.");
        firebase.database().ref("users/" + user.uid).update({ balance: bal - bet });
        mineData = Array(25).fill("safe");
        let placed = 0;
        while (placed < count) {
          const i = Math.floor(Math.random() * 25);
          if (mineData[i] === "safe") {
            mineData[i] = "mine";
            placed++;
          }
        }
        renderMineGrid();
        document.getElementById("mineResult").innerText = "Click safe tiles";
      });
    }

    function renderMineGrid() {
      const grid = document.getElementById("mineGrid");
      grid.innerHTML = "";
      mineData.forEach((type, idx) => {
        const div = document.createElement("div");
        div.className = "cell";
        div.onclick = () => revealCell(div, idx);
        grid.appendChild(div);
      });
    }

    function revealCell(cell, idx) {
      if (cell.classList.contains("revealed")) return;
      cell.classList.add("revealed");
      if (mineData[idx] === "mine") {
        cell.classList.add("mine");
        document.getElementById("mineResult").innerText = "💥 You hit a mine! Game over.";
      } else {
        cell.innerText = "✔️";
        document.getElementById("mineResult").innerText = "✅ Safe! Keep going.";
      }
    }
  </script>
</body>
</html>
